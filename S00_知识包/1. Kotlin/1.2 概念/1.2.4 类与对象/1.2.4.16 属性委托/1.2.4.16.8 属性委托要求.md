
## ğŸ” å±æ€§å§”æ‰˜è¦æ±‚

ğŸ”’ å¯¹äºä¸€ä¸ª*åªè¯»*å±æ€§ï¼ˆå³ `val` å£°æ˜çš„ï¼‰ï¼Œå§”æ‰˜å¿…é¡»æä¾›ä¸€ä¸ªæ“ä½œç¬¦å‡½æ•° `getValue()`ï¼Œè¯¥å‡½æ•°å…·æœ‰ä»¥ä¸‹å‚æ•°ï¼š

* ğŸ¯ `thisRef` å¿…é¡»ä¸*å±æ€§æ‰€æœ‰è€…*ç±»å‹ï¼ˆå¯¹äºæ‰©å±•å±æ€§å¿…é¡»æ˜¯è¢«æ‰©å±•çš„ç±»å‹ï¼‰ç›¸åŒæˆ–è€…æ˜¯å…¶è¶…ç±»å‹ã€‚

* ğŸ”‘ `property`  å¿…é¡»æ˜¯ç±»å‹ `KProperty<*>` æˆ–å…¶è¶…ç±»å‹ã€‚

ğŸ”„ `getValue()` å¿…é¡»è¿”å›ä¸å±æ€§ç›¸åŒçš„ç±»å‹ï¼ˆæˆ–å…¶å­ç±»å‹ï¼‰ã€‚

```kotlin
class Resource

class Owner {
    val valResource: Resource by ResourceDelegate()
}

class ResourceDelegate {
    operator fun getValue(thisRef: Owner, property: KProperty<*>): Resource {
        return Resource()
    }
}
```

ğŸ”„ å¯¹äºä¸€ä¸ª**å¯å˜**å±æ€§ï¼ˆå³ `var` å£°æ˜çš„ï¼‰ï¼Œå§”æ‰˜å¿…é¡»é¢å¤–æä¾›ä¸€ä¸ªæ“ä½œç¬¦å‡½æ•° `setValue()`ï¼Œ
è¯¥å‡½æ•°å…·æœ‰ä»¥ä¸‹å‚æ•°ï¼š

* ğŸ¯ `thisRef` å¿…é¡»ä¸*å±æ€§æ‰€æœ‰è€…*ç±»å‹ï¼ˆå¯¹äºæ‰©å±•å±æ€§å¿…é¡»æ˜¯è¢«æ‰©å±•çš„ç±»å‹ï¼‰ç›¸åŒæˆ–è€…æ˜¯å…¶è¶…ç±»å‹ã€‚

* ğŸ”‘ `property` å¿…é¡»æ˜¯ç±»å‹ `KProperty<*>` æˆ–å…¶è¶…ç±»å‹ã€‚

* ğŸ“Š `value` å¿…é¡»ä¸å±æ€§ç±»å‹ç›¸åŒï¼ˆæˆ–è€…æ˜¯å…¶è¶…ç±»å‹ï¼‰ã€‚

```kotlin
class Resource

class Owner {
    var varResource: Resource by ResourceDelegate()
}

class ResourceDelegate(private var resource: Resource = Resource()) {
    operator fun getValue(thisRef: Owner, property: KProperty<*>): Resource {
        return resource
    }
    operator fun setValue(thisRef: Owner, property: KProperty<*>, value: Any?) {
        if (value is Resource) {
            resource = value
        }
    }
}
```

ğŸ”§ `getValue()` æˆ–/ä¸ `setValue()` å‡½æ•°å¯ä»¥é€šè¿‡å§”æ‰˜ç±»çš„æˆå‘˜å‡½æ•°æä¾›æˆ–è€…ç”±æ‰©å±•å‡½æ•°æä¾›ã€‚

ğŸ”„ å½“ä½ éœ€è¦å§”æ‰˜å±æ€§åˆ°åŸæœ¬æœªæä¾›çš„è¿™äº›å‡½æ•°çš„å¯¹è±¡æ—¶åè€…ä¼šæ›´ä¾¿åˆ©ã€‚

ğŸ·ï¸ ä¸¤å‡½æ•°éƒ½éœ€è¦ç”¨ `operator` å…³é”®å­—æ¥è¿›è¡Œæ ‡è®°ã€‚

ğŸ­ ä½ å¯ä»¥ä½¿ç”¨ Kotlin æ ‡å‡†åº“ä¸­çš„ `ReadOnlyProperty` å’Œ `ReadWriteProperty` æ¥å£ï¼Œé€šè¿‡åŒ¿åå¯¹è±¡åˆ›å»ºå§”æ‰˜ï¼Œè€Œæ— éœ€åˆ›å»ºæ–°çš„ç±»ã€‚

ğŸ› ï¸ å®ƒä»¬æä¾›äº†æ‰€éœ€çš„æ–¹æ³•ï¼š`getValue()` åœ¨ `ReadOnlyProperty` ä¸­å£°æ˜ï¼›`ReadWriteProperty` æ‰©å±•äº†å®ƒå¹¶æ·»åŠ äº† `setValue()`ã€‚

ğŸ”„ è¿™æ„å‘³ç€ä½ å¯ä»¥åœ¨éœ€è¦ `ReadOnlyProperty` çš„åœ°æ–¹ä¼ é€’ `ReadWriteProperty`ã€‚

```kotlin
fun resourceDelegate(resource: Resource = Resource()): ReadWriteProperty<Any?, Resource> =
    object : ReadWriteProperty<Any?, Resource> {
        var curValue = resource
        override fun getValue(thisRef: Any?, property: KProperty<*>): Resource = curValue
        override fun setValue(thisRef: Any?, property: KProperty<*>, value: Resource) {
            curValue = value
        }
    }

val readOnlyResource: Resource by resourceDelegate()  // ReadWriteProperty as val
var readWriteResource: Resource by resourceDelegate()
```