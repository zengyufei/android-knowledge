### ğŸŒ API è¯·æ±‚å“åº”å¤„ç†

ğŸ”’ ä½ å¯ä»¥ä½¿ç”¨å¯†å°ç±»å’Œå¯†å°æ¥å£æ¥å®ç°ä¸€ä¸ªå¤„ç† API è¯·æ±‚å’Œå“åº”çš„ç”¨æˆ·è®¤è¯ç³»ç»Ÿã€‚

ğŸ”‘ è¯¥ç”¨æˆ·è®¤è¯ç³»ç»Ÿå…·æœ‰ç™»å½•å’Œç™»å‡ºåŠŸèƒ½ã€‚

ğŸ” `ApiRequest` å¯†å°æ¥å£å®šä¹‰äº†ç‰¹å®šçš„è¯·æ±‚ç±»å‹ï¼šç”¨äºç™»å½•çš„ `LoginRequest` å’Œç”¨äºç™»å‡ºæ“ä½œçš„ `LogoutRequest`ã€‚

ğŸ“¦ å¯†å°ç±» `ApiResponse` å°è£…äº†ä¸åŒçš„å“åº”åœºæ™¯ï¼šåŒ…å«ç”¨æˆ·æ•°æ®çš„ `UserSuccess`ã€ç”¨äºä¸å­˜åœ¨ç”¨æˆ·çš„ `UserNotFound` ä»¥åŠç”¨äºä»»ä½•å¤±è´¥æƒ…å†µçš„ `Error`ã€‚

ğŸ”„ `handleRequest` å‡½æ•°ä½¿ç”¨ `when` è¡¨è¾¾å¼ä»¥ç±»å‹å®‰å…¨çš„æ–¹å¼å¤„ç†è¿™äº›è¯·æ±‚ï¼Œè€Œ `getUserById` åˆ™æ¨¡æ‹Ÿç”¨æˆ·æ£€ç´¢ï¼š

```kotlin
// ğŸ“¦ å¯¼å…¥å¿…è¦çš„æ¨¡å—
import io.ktor.server.application.*
import io.ktor.server.resources.*

import kotlinx.serialization.*

// ğŸ”’ ä½¿ç”¨Ktorèµ„æºå®šä¹‰APIè¯·æ±‚çš„å¯†å°æ¥å£
@Resource("api")
sealed interface ApiRequest

@Serializable
@Resource("login")
data class LoginRequest(val username: String, val password: String) : ApiRequest


@Serializable
@Resource("logout")
object LogoutRequest : ApiRequest

// ğŸ”„ å®šä¹‰ApiResponseå¯†å°ç±»ï¼ŒåŒ…å«è¯¦ç»†çš„å“åº”ç±»å‹
sealed class ApiResponse {
    data class UserSuccess(val user: UserData) : ApiResponse()
    data object UserNotFound : ApiResponse()
    data class Error(val message: String) : ApiResponse()
}

// ğŸ‘¤ ç”¨äºæˆåŠŸå“åº”çš„ç”¨æˆ·æ•°æ®ç±»
data class UserData(val userId: String, val name: String, val email: String)

// ğŸ” éªŒè¯ç”¨æˆ·å‡­è¯çš„å‡½æ•°ï¼ˆä»…ç”¨äºæ¼”ç¤ºç›®çš„ï¼‰
fun isValidUser(username: String, password: String): Boolean {
    // ä¸€äº›éªŒè¯é€»è¾‘ï¼ˆè¿™åªæ˜¯ä¸€ä¸ªå ä½ç¬¦ï¼‰ ğŸ”
    return username == "validUser" && password == "validPass"
}

// ğŸ›ï¸ å¤„ç†APIè¯·æ±‚å¹¶æä¾›è¯¦ç»†å“åº”çš„å‡½æ•°
fun handleRequest(request: ApiRequest): ApiResponse {
    return when (request) {
        is LoginRequest -> {
            if (isValidUser(request.username, request.password)) {
                ApiResponse.UserSuccess(UserData("userId", "userName", "userEmail"))
            } else {
                ApiResponse.Error("æ— æ•ˆçš„ç”¨æˆ·åæˆ–å¯†ç ") // ğŸš«
            }
        }
        is LogoutRequest -> {
            // å‡è®¾æ³¨é”€æ“ä½œæ€»æ˜¯æˆåŠŸï¼ˆæœ¬ä¾‹ä¸­ï¼‰ ğŸ”“
            ApiResponse.UserSuccess(UserData("userId", "userName", "userEmail")) // ç”¨äºæ¼”ç¤º
        }
    }
}

// ğŸ” æ¨¡æ‹ŸgetUserByIdè°ƒç”¨çš„å‡½æ•°
fun getUserById(userId: String): ApiResponse {
    return if (userId == "validUserId") {
        ApiResponse.UserSuccess(UserData("validUserId", "John Doe", "john@example.com"))
    } else {
        ApiResponse.UserNotFound
    }
    // é”™è¯¯å¤„ç†ä¹Ÿä¼šå¯¼è‡´Errorå“åº”ã€‚ âš ï¸
}

// ğŸš€ ä¸»å‡½æ•°ï¼Œç”¨äºæ¼”ç¤ºä½¿ç”¨
fun main() {
    val loginResponse = handleRequest(LoginRequest("user", "pass"))
    println(loginResponse)

    val logoutResponse = handleRequest(LogoutRequest)
    println(logoutResponse)

    val userResponse = getUserById("validUserId")
    println(userResponse)

    val userNotFoundResponse = getUserById("invalidId")
    println(userNotFoundResponse)
}
```